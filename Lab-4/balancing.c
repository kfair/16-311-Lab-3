#pragma config(Sensor, S1,     frontSensor,    sensorLightActive)
#pragma config(Sensor, S2,     backSensor,     sensorLightActive)
#pragma config(Motor,  motorB,          leftMotor,     tmotorNXT, PIDControl, encoder)
#pragma config(Motor,  motorA,          rightMotor,    tmotorNXT, PIDControl, encoder)
//*!!Code automatically generated by 'ROBOTC' configuration wizard               !!*//

// Constants
int p = 25;
float i = 0.05;
float d = 0;

task main()
{
	float prevError = 0;

	// Difference between front and back sensors
	int correction = 9;

	int sumError = 0;
	int motorOutput = 0;
	float curError = 0;
	float diff = 0;

	while(true) {

		int front = SensorValue(frontSensor);
		int back = SensorValue(backSensor) + correction;

		curError = front - back;			// Current error
		sumError += curError;					// Accumulated error
		diff = curError - prevError;	// Current difference

		motorOutput = round(curError*p + sumError*i + diff*d);
		prevError = curError;

 		motor[leftMotor] = motorOutput;
		motor[rightMotor] = motorOutput;
	}
}
